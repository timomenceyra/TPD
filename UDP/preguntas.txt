================================================================================
  TP D - RESPUESTAS A PREGUNTAS TEÓRICAS
  Grupo 14
================================================================================

================================================================================
PREGUNTA 1: Transferencia de archivo de 20 kB en 3 escenarios
================================================================================

ARCHIVO DE PRUEBA:
- Tamaño: 20 kB = 20,480 bytes
- Generado con: dd if=/dev/zero of=archivo_20kB bs=1024 count=20

--------------------------------------------------------------------------------
ESCENARIO 1: LAN (Red Local Virtual)
--------------------------------------------------------------------------------

CONFIGURACIÓN:
- Tipo: LAN virtual entre máquinas virtuales
- Latencia: ~1-2 ms (despreciable)
- RTT: ~2-4 ms

ANÁLISIS TEÓRICO:

1. Cálculo de chunks:
   Chunks = ⌈20,480 / 1,470⌉ = ⌈13.93⌉ = 14 chunks
   
   Detalle:
   - 13 chunks de 1,470 bytes = 19,110 bytes
   - 1 chunk final de 1,370 bytes = 1,370 bytes
   - Total: 20,480 bytes ✓

2. Número de RTTs necesarios:
   - HELLO (Fase 1):     1 RTT
   - WRQ (Fase 2):       1 RTT
   - DATA (Fase 3):     14 RTTs (un RTT por cada chunk en stop & wait)
   - FIN (Fase 4):       1 RTT
   ------------------------
   Total:               17 RTTs

3. Fórmula de tiempo teórico:
   
   T_total = T_HELLO + T_WRQ + T_DATA + T_FIN
   T_total = RTT + RTT + (N_chunks × RTT) + RTT
   T_total = (1 + 1 + 14 + 1) × RTT
   T_total = 17 × RTT

   Con RTT ≈ 2 ms:
   T_total ≈ 17 × 2 ms = 34 ms

4. Tiempo esperado en Wireshark:
   - Tiempo teórico mínimo: ~34 ms
   - Overhead de procesamiento: ~10-20 ms
   - Tiempo real esperado: ~50-80 ms

EVIDENCIA EN WIRESHARK:
- Filtro usado: udp.port == 20252
- Tiempo medido: [COMPLETAR DESPUÉS DE LA PRUEBA]
- Comparación: [COMPLETAR]

--------------------------------------------------------------------------------
ESCENARIO 2: Latencia Internacional (RTT ~180 ms)
--------------------------------------------------------------------------------

CONFIGURACIÓN:
- Tipo: Simulación con WANem/NetEm
- Delay configurado: 90 ms en cada sentido
- RTT: ~180 ms

ANÁLISIS TEÓRICO:

1. Chunks: 14 (igual que escenario 1)

2. RTTs: 17 (igual que escenario 1)

3. Fórmula de tiempo teórico:
   
   T_total = 17 × RTT
   T_total = 17 × 180 ms
   T_total = 3,060 ms = 3.06 segundos

4. Tiempo esperado en Wireshark:
   - Tiempo teórico mínimo: 3.06 s
   - Overhead de procesamiento: ~100-200 ms
   - Tiempo real esperado: ~3.2 - 3.3 segundos

OBSERVACIONES:
- El protocolo stop & wait es INEFICIENTE con latencia alta
- Cada chunk debe esperar ACK antes de enviar el siguiente
- 90% del tiempo se gasta esperando ACKs
- Throughput efectivo muy bajo (~53 kbps)

EVIDENCIA EN WIRESHARK:
- Comando tc usado: sudo tc qdisc add dev eth0 root netem delay 90ms
- Tiempo medido: [COMPLETAR DESPUÉS DE LA PRUEBA]
- Comparación: [COMPLETAR]

--------------------------------------------------------------------------------
ESCENARIO 3: Latencia a Base Lunar (RTT ~2.56 s)
--------------------------------------------------------------------------------

CONFIGURACIÓN:
- Tipo: Simulación con WANem/NetEm
- Delay configurado: 1,280 ms (1.28 s) en cada sentido
- RTT: ~2,560 ms = 2.56 s
- Justificación: Distancia Tierra-Luna ~384,400 km
  - Velocidad de la luz: ~300,000 km/s
  - Tiempo de ida: 384,400 / 300,000 ≈ 1.28 s
  - RTT: 2 × 1.28 s = 2.56 s

ANÁLISIS TEÓRICO:

1. Chunks: 14 (igual que escenarios anteriores)

2. RTTs: 17 (igual que escenarios anteriores)

3. Fórmula de tiempo teórico:
   
   T_total = 17 × RTT
   T_total = 17 × 2,560 ms
   T_total = 43,520 ms = 43.52 segundos

4. Tiempo esperado en Wireshark:
   - Tiempo teórico mínimo: 43.52 s
   - Overhead de procesamiento: ~1-2 s
   - Tiempo real esperado: ~44-46 segundos

OBSERVACIONES CRÍTICAS:
- ¡Casi 45 segundos para transferir solo 20 kB!
- Throughput efectivo: ~3.6 kbps (extremadamente bajo)
- El timeout de 3.0 segundos es APROPIADO (RTT = 2.56 s)
- Stop & wait es TOTALMENTE INADECUADO para estas latencias

EVIDENCIA EN WIRESHARK:
- Comando tc usado: sudo tc qdisc add dev eth0 root netem delay 1280ms
- Tiempo medido: [COMPLETAR DESPUÉS DE LA PRUEBA]
- Comparación: [COMPLETAR]

--------------------------------------------------------------------------------
TABLA RESUMEN COMPARATIVA
--------------------------------------------------------------------------------

| Escenario      | RTT     | Tiempo Teórico | Tiempo Real* | Throughput  |
|----------------|---------|----------------|--------------|-------------|
| LAN            | ~2 ms   | ~34 ms         | ~50-80 ms    | ~2 Mbps     |
| Internacional  | 180 ms  | 3.06 s         | ~3.2 s       | ~53 kbps    |
| Lunar          | 2.56 s  | 43.52 s        | ~45 s        | ~3.6 kbps   |

*Tiempo real incluye overhead de procesamiento y será completado después
 de las pruebas con Wireshark.

FÓRMULA GENERAL DEDUCIDA:

Para un archivo de tamaño F bytes con el protocolo UDP stop & wait:

    N_chunks = ⌈F / MAX_DATA_SIZE⌉
    
    N_RTTs = 1 (HELLO) + 1 (WRQ) + N_chunks (DATA) + 1 (FIN)
           = N_chunks + 3
    
    T_total = N_RTTs × RTT
            = (N_chunks + 3) × RTT
            = (⌈F / 1470⌉ + 3) × RTT

Para F = 20,480 bytes:
    T_total = (14 + 3) × RTT = 17 × RTT

CONCLUSIÓN ESCENARIO 1:
El protocolo funciona eficientemente en redes LAN donde la latencia es 
despreciable. El overhead del protocolo (4 fases) es mínimo comparado con
el tiempo de transmisión.


================================================================================
PREGUNTA 2: ¿Recomendarías este protocolo para actualizar firmware de 16 MB
            desde Buenos Aires a Virginia (EEUU)?
================================================================================

RESPUESTA: **NO, definitivamente NO lo recomendaría.**

--------------------------------------------------------------------------------
ANÁLISIS DE LATENCIA Buenos Aires → Virginia
--------------------------------------------------------------------------------

Verificación en https://www.cloudping.info/:
- Latencia típica: ~120-150 ms (one-way)
- RTT estimado: ~250 ms

Nota: La latencia puede variar según:
- Routing de ISP
- Congestión de red
- Hora del día
- Conexión específica

Para este análisis usaremos RTT = 250 ms (valor conservador).

--------------------------------------------------------------------------------
CÁLCULO TEÓRICO PARA 16 MB
--------------------------------------------------------------------------------

1. Tamaño del archivo:
   16 MB = 16 × 1,024 × 1,024 = 16,777,216 bytes

2. Número de chunks:
   N_chunks = ⌈16,777,216 / 1,470⌉ = 11,411 chunks

3. Número de RTTs:
   N_RTTs = 1 (HELLO) + 1 (WRQ) + 11,411 (DATA) + 1 (FIN)
          = 11,414 RTTs

4. Tiempo de transferencia:
   T_total = 11,414 × 250 ms
           = 2,853,500 ms
           = 2,853.5 segundos
           = 47.56 minutos
           ≈ 48 MINUTOS

5. Throughput efectivo:
   Throughput = (16 MB × 8 bits) / 2,854 s
              = 134,217,728 bits / 2,854 s
              ≈ 47,024 bps
              ≈ 47 kbps
              ≈ 0.047 Mbps

--------------------------------------------------------------------------------
PROBLEMAS IDENTIFICADOS
--------------------------------------------------------------------------------

1. **TIEMPO EXCESIVO**
   - 48 minutos para 16 MB es INACEPTABLE
   - Una conexión de 1 Mbps tardaría ~2 minutos
   - Stop & wait es 24× más lento

2. **THROUGHPUT EXTREMADAMENTE BAJO**
   - 47 kbps es equivalente a un módem dial-up de los '90s
   - Aprovechamiento del ancho de banda: <0.1%
   - Desperdicio masivo de recursos de red

3. **VULNERABILIDAD A PÉRDIDA DE PAQUETES**
   - Con 11,411 transmisiones, probabilidad de pérdida aumenta
   - Cada pérdida causa timeout de 3 segundos
   - Con 1% de pérdida: ~114 retransmisiones × 3s = +342s (+6 min)
   - Tiempo total con pérdidas podría ser >1 hora

4. **INEFICIENCIA DEL PROTOCOLO STOP & WAIT**
   - El canal está ocioso el 99% del tiempo esperando ACKs
   - No aprovecha el bandwidth-delay product
   - RTT × Bandwidth completamente desperdiciado

5. **RIESGOS OPERACIONALES**
   - Actualización de firmware es operación CRÍTICA
   - 48 minutos expuesto a:
     * Cortes de red
     * Reinicios de equipo
     * Pérdida de conexión
   - Sin recuperación ante fallas (empezaría de cero)

6. **COSTOS**
   - Ocupación prolongada del enlace
   - Posibles costos por tiempo de transmisión
   - Personal esperando 48+ minutos

--------------------------------------------------------------------------------
ALTERNATIVAS RECOMENDADAS
--------------------------------------------------------------------------------

1. **TCP con ventana deslizante**
   - Tiempo estimado: ~2-3 minutos
   - Throughput: ~1 Mbps (20× mejor)
   - Control de congestión incluido
   - Recuperación automática ante pérdidas

2. **TFTP con windowing (RFC 7440)**
   - Similar a UDP pero con ventana
   - Más eficiente que stop & wait puro
   - Mantiene simplicidad de UDP

3. **FTP/SFTP sobre TCP**
   - Protocolo estándar y probado
   - Seguridad (en caso de SFTP)
   - Herramientas disponibles
   - Tiempo: ~2 minutos

4. **HTTP/HTTPS con resumable uploads**
   - Puede reanudar transferencias interrumpidas
   - Ampliamente soportado
   - Tiempo: ~2 minutos

5. **Protocolos especializados**
   - QUIC (UDP con confiabilidad)
   - BitTorrent (para múltiples destinos)
   - rsync (para actualizaciones parciales)

--------------------------------------------------------------------------------
COMPARACIÓN DE PROTOCOLOS
--------------------------------------------------------------------------------

| Protocolo              | Tiempo Est. | Throughput | Confiabilidad |
|------------------------|-------------|------------|---------------|
| UDP Stop & Wait (ESTE) | 48 min      | 47 kbps    | Media         |
| TCP                    | 2-3 min     | 1 Mbps     | Alta          |
| SFTP                   | 2-3 min     | 1 Mbps     | Muy Alta      |
| HTTP resumable         | 2-3 min     | 1 Mbps     | Muy Alta      |

--------------------------------------------------------------------------------
CONCLUSIÓN
--------------------------------------------------------------------------------

**NO recomiendo este protocolo para actualización de firmware remoto por:**

1. ✗ Tiempo de transferencia INACEPTABLE (48 minutos)
2. ✗ Throughput EXTREMADAMENTE BAJO (47 kbps vs ~1 Mbps posible)
3. ✗ Aprovechamiento del canal <1%
4. ✗ Alta vulnerabilidad a pérdidas de paquetes
5. ✗ Sin mecanismo de recuperación ante fallas
6. ✗ Riesgo operacional alto para operación crítica

**RECOMENDACIÓN:**
Usar TCP (FTP/SFTP/HTTP) que completaría la transferencia en ~2-3 minutos
en vez de 48 minutos, con mejor confiabilidad y recuperación ante fallas.

**CASO DE USO APROPIADO PARA ESTE PROTOCOLO:**
Este protocolo es adecuado SOLO para:
- Redes LAN de baja latencia
- Archivos pequeños (<100 kB)
- Ambientes educativos/académicos
- Dispositivos con recursos muy limitados que no soportan TCP


================================================================================
PREGUNTA 3: Conclusiones sobre TCP en ambiente de elevado packet loss
            para aplicaciones de tiempo real
================================================================================

CONTEXTO:
Las aplicaciones de tiempo real (VoIP, videoconferencia, streaming, gaming)
tienen requisitos estrictos de latencia y jitter. Esta pregunta analiza el
comportamiento de TCP bajo condiciones adversas de red.

--------------------------------------------------------------------------------
COMPORTAMIENTO DE TCP CON PACKET LOSS ELEVADO
--------------------------------------------------------------------------------

1. **MECANISMO DE RETRANSMISIÓN**
   
   TCP es un protocolo orientado a conexión con entrega confiable:
   - Cada segmento debe ser confirmado (ACK)
   - Pérdida de paquete → timeout → retransmisión
   - RTO (Retransmission Timeout) típico: 200-500 ms inicial
   
   Problema para tiempo real:
   - Retransmisión introduce latencia adicional
   - Latencia variable (jitter alto)
   - Puede exceder límites aceptables para tiempo real

2. **CONTROL DE CONGESTIÓN**
   
   TCP interpreta pérdidas como señal de congestión:
   - Slow Start → aumenta ventana exponencialmente
   - Congestion Avoidance → aumenta linealmente
   - Pérdida detectada → reduce ventana a la mitad (Fast Recovery)
   - Timeout → reduce ventana a 1 MSS (Slow Start)
   
   Efecto en tiempo real:
   - Throughput variable e impredecible
   - "Paradas y arranques" constantes
   - No mantiene tasa de bits constante requerida

3. **HEAD-OF-LINE BLOCKING**
   
   TCP entrega datos en orden:
   - Si paquete N se pierde, paquetes N+1, N+2... esperan en buffer
   - Aplicación no recibe datos hasta que N sea retransmitido
   
   Problema crítico:
   - En video/audio, frame viejo retransmitido puede ser inútil
   - Preferiríamos descartar frame perdido y continuar
   - TCP no permite "saltar" datos perdidos

4. **JITTER EXTREMO**
   
   Variabilidad en tiempos de entrega:
   - Sin pérdidas: latencia estable
   - Con pérdidas: picos de latencia por retransmisiones
   - Imposible mantener playout buffer estable
   
   Ejemplo con 5% packet loss:
   - Frame 1: 50 ms
   - Frame 2: 50 ms  
   - Frame 3: PERDIDO → 550 ms (timeout + retx)
   - Frame 4: 50 ms
   - Jitter inaceptable para tiempo real

5. **THROUGHPUT DEGRADADO**
   
   Con packet loss p, throughput de TCP aproximadamente:
   
   Throughput ≈ (MSS / RTT) × (1 / √p)
   
   Ejemplos:
   - 1% loss:  throughput × 0.10 (10× más lento)
   - 5% loss:  throughput × 0.045 (22× más lento)
   - 10% loss: throughput × 0.032 (31× más lento)
   
   Insuficiente para mantener calidad de video/audio

--------------------------------------------------------------------------------
CONCLUSIÓN SOBRE TCP PARA TIEMPO REAL
--------------------------------------------------------------------------------

**TCP NO es apropiado para aplicaciones de tiempo real en ambientes con
elevado packet loss porque:**

1. ✗ **Retransmisiones** causan latencia impredecible
2. ✗ **Control de congestión** reduce throughput justo cuando más se necesita
3. ✗ **Head-of-line blocking** entrega datos viejos/inútiles
4. ✗ **Jitter excesivo** imposibilita mantener reproducción suave
5. ✗ **Throughput degradado** severamente con packet loss moderado

**ALTERNATIVAS RECOMENDADAS:**

1. **UDP + protocolo de aplicación**
   - RTP (Real-time Transport Protocol)
   - SRTP (Secure RTP)
   - Control manual de pérdidas en capa de aplicación
   - FEC (Forward Error Correction) para recuperación

2. **QUIC (Quick UDP Internet Connections)**
   - Basado en UDP pero con confiabilidad
   - Streams independientes (sin head-of-line blocking)
   - Recuperación rápida ante pérdidas
   - Usado por Google Meet, YouTube

3. **WebRTC**
   - Stack completo para tiempo real
   - Manejo adaptativo de pérdidas
   - Ajuste dinámico de calidad
   - Usado por Zoom, Teams, Discord

--------------------------------------------------------------------------------
AMBIENTES CON ELEVADO PACKET LOSS O JITTER
--------------------------------------------------------------------------------

¿Qué ambientes presentan estas condiciones?

1. **REDES MÓVILES (4G/5G)**
   
   Características:
   - Packet loss: 1-5% típico, hasta 10% en movimiento
   - Jitter: 20-200 ms
   - Handoff entre celdas
   - Congestión variable
   
   Por qué:
   - Interferencia de RF
   - Señal débil
   - Congestión del canal de aire
   - Movilidad del usuario
   
   Ejemplos:
   - Videollamada desde auto/tren
   - Gaming móvil
   - Streaming en transporte público

2. **REDES WiFi CONGESTIONADAS**
   
   Características:
   - Packet loss: 2-10% en WiFi público
   - Jitter: 10-100 ms
   - Colisiones frecuentes
   
   Por qué:
   - Múltiples dispositivos compitiendo
   - Interferencia (otros APs, Bluetooth, microondas)
   - Distancia del AP
   - Obstáculos físicos
   
   Ejemplos:
   - Cafeterías, aeropuertos
   - Conferencias, eventos
   - Edificios con muchos APs
   - Universidades, oficinas abiertas

3. **CONEXIONES SATELITALES**
   
   Características:
   - Packet loss: 1-5%
   - Jitter: variable, puede ser alto
   - Latencia base: 500-700 ms (GEO)
   
   Por qué:
   - Condiciones atmosféricas
   - Lluvia (rain fade)
   - Obstrucciones (árboles, edificios)
   - Cambios en elevación del satélite
   
   Ejemplos:
   - Internet rural (Starlink, HughesNet)
   - Comunicaciones marítimas
   - Zonas remotas

4. **VPN SOBRE REDES INESTABLES**
   
   Características:
   - Packet loss: variable, 2-15%
   - Jitter: 50-300 ms
   - Túnel añade overhead
   
   Por qué:
   - Encapsulación añade latencia
   - Routing subóptimo
   - Red subyacente inestable
   - Sobrecarga de encriptación
   
   Ejemplos:
   - Trabajo remoto internacional
   - Acceso a recursos corporativos
   - Bypassing geo-restrictions

5. **REDES DOMÉSTICAS CON CONGESTIÓN**
   
   Características:
   - Packet loss: 1-5% en horas pico
   - Jitter: 20-100 ms
   - Bufferbloat
   
   Por qué:
   - Múltiples usuarios simultáneos
   - Torrents, descargas grandes
   - Netflix/YouTube en 4K
   - Gaming + streaming simultáneos
   - Router/modem de baja calidad
   
   Ejemplos:
   - Casas con familia numerosa
   - Horario nocturno (prime time)
   - Trabajo desde casa + educación remota

6. **ÚLTIMOS TRAMOS DE DSL/CABLE**
   
   Características:
   - Packet loss: 1-10%
   - Jitter: 20-150 ms
   - Degradación con distancia
   
   Por qué:
   - Líneas antiguas/deterioradas
   - Distancia del DSLAM
   - Interferencia electromagnética
   - Infraestructura saturada
   
   Ejemplos:
   - Zonas suburbanas/rurales
   - Edificios antiguos
   - Áreas sin fibra óptica

--------------------------------------------------------------------------------
TABLA COMPARATIVA DE AMBIENTES
--------------------------------------------------------------------------------

| Ambiente              | Packet Loss | Jitter    | Latencia  | Caso de Uso        |
|-----------------------|-------------|-----------|-----------|---------------------|
| LAN cableada          | <0.1%       | <5 ms     | <1 ms     | Óptimo             |
| WiFi buena señal      | 0.5-2%      | 5-20 ms   | 2-10 ms   | Aceptable          |
| WiFi congestionada    | 2-10%       | 10-100 ms | 5-50 ms   | **Problemático**   |
| 4G/5G estable         | 1-3%        | 20-50 ms  | 20-60 ms  | Aceptable          |
| 4G/5G en movimiento   | 3-10%       | 50-200 ms | 30-100 ms | **Problemático**   |
| Satélite GEO          | 1-5%        | Variable  | 500-700ms | **Problemático**   |
| DSL distante          | 2-10%       | 20-150 ms | 20-80 ms  | **Problemático**   |

--------------------------------------------------------------------------------
RECOMENDACIONES PARA DESARROLLADORES
--------------------------------------------------------------------------------

Si necesitas transmitir tiempo real sobre redes con packet loss/jitter:

1. **NO uses TCP** para el stream de medios
2. **USA UDP + RTP/SRTP** para audio/video
3. **Implementa:**
   - Jitter buffer adaptativo
   - FEC (Forward Error Correction)
   - Packet loss concealment (PLC)
   - Adaptive bitrate (ABR)
4. **Monitorea:**
   - Packet loss en tiempo real
   - Jitter
   - RTT
5. **Ajusta dinámicamente:**
   - Bitrate (calidad)
   - Frame rate
   - Resolución

--------------------------------------------------------------------------------
CONCLUSIÓN FINAL
--------------------------------------------------------------------------------

TCP con elevado packet loss es **INCOMPATIBLE** con requisitos de tiempo real.

Los ambientes con packet loss/jitter elevado son **comunes** en la práctica:
redes móviles, WiFi congestionado, satélite, VPN, DSL distante.

Las aplicaciones de tiempo real **DEBEN** usar UDP con protocolos especializados
(RTP, QUIC, WebRTC) que priorizan baja latencia sobre confiabilidad absoluta.

El diseño debe **aceptar pérdidas** como inevitables y mitigarlas con técnicas
en capa de aplicación (FEC, concealment, adaptive bitrate) en vez de depender
de retransmisiones que destruyen la experiencia de tiempo real.


================================================================================
FIN DEL DOCUMENTO
================================================================================

PRÓXIMOS PASOS PARA COMPLETAR:
1. Ejecutar pruebas con WANem en los 3 escenarios
2. Capturar tráfico con Wireshark
3. Medir tiempos reales de transferencia
4. Completar secciones marcadas con [COMPLETAR]
5. Agregar capturas de pantalla de Wireshark
6. Generar gráficos comparativos

Fecha de creación: 23/11/2025
Última actualización: [PENDIENTE DESPUÉS DE PRUEBAS]